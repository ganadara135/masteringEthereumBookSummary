# Consensus
컨센서스 규칙이란 참여자 모두가 시스템이 탈중앙화되고 결정론적으로 운영하기위해 동의해야 하는 것임   
컴퓨터과학측면에서 컨센서스란 용어는 블록체인보다 먼저 등장했고 분산시스템에서 상태를 동기화하기 위한 광범위한 문제에 적용된다  
예로서 분산시스템에서 다른 참여자간에 시스템 범위의 단일 상태를 유지하기 위해 사용함  
위 행위 최종 상태를 "컨센서스 완료"라고 함  

탈중앙회된 기록 유지와 검증의 핵심 기능에 대해서는 신뢰성을 단일 환경에 유지하는 것은 문제적 요소가 될 수 있음  
왜냐하면 상태 업데이트를 통해 발생된 정보가 정확한 것인지 확신할 수 없음  
이러한 다소 일반적인 과제는 특히 분권화된 네트워크에서 두드러지는데, 그 이유는 무엇이 진실인지 결정할 중심 실체가 없기 때문이다  
검열에 저항할 수 있는 역량과 정보 접근 허가를 위한 권한의 의존도가 낮기 때문에, 중앙 의사결정 주체가 없는 것이 블록체인 플랫폼의 주요 매력 중 하나이다  
그러나 이러한 혜택은 비용이 듭니다.   
신뢰할 수 있는 중재자가 없으면 다른 수단을 사용하여 의견 불일치, 기만 또는 차이를 조정해야 합니다.   
합의 알고리즘은 보안과 분권을 조정하는 데 사용되는 메커니즘입니다.  

블록체인에서 컨센서스란 시스템의 핵심 특징이다  
컨센서스란 규칙자가 없는 완고한 규칙 시스템을 만들기위해 의도된 것임  
책임지는 한 사람, 조직, 집단이 없다.  
오히려, 권력과 통제는 규칙을 따르고 정직하게 행동함으로써 사리사욕을 충족시키는 광범위한 참여자들의 네트워크를 통해 확산된다.

적대적 조건 하에서 중앙 집중식 통제 없이 분산 네트워크를 통해 합의에 도달할 수 있는 능력이 모든 공개 블록 체인의 핵심 원칙입니다.   
이러한 과제를 해결하고 탈중앙화된 가치 있는 재산을 유지하기 위해 커뮤니티는 다양한 합의 모델을 계속 실험하고 있습니다.   
이 장에서는 이러한 합의 모델과 Ethereum과 같은 스마트컨트랙트 블록체인에 미칠 예상 영향에 대해 살펴봅니다.
|  |  |  
|--|--|  
|노트|합의 알고리즘은 블록 체인의 작동 방식에서 중요한 부분을 차지하지만, 스마트 컨트랙트의 추상화에 한참 아래인 기초 계층에서 작동합니다. 스마트컨트랙트 작성자들에게는 컨센서스의 세부 내용이 대부분 숨겨져 있는 셈이다. 인터넷을 사용하기 위해 라우팅이 어떻게 작동하는지 알 필요가 없을 뿐 아니라, Ethereum을 사용하기 위해 어떻게 작동하는지 알 필요도 없습니다|  

# Consensus via Proof of Work
원조 블록체인을 만든 비트코인이 작업 증명(PoW)이라는 컨센서스 알고리즘을 개발했다  
PoW의 구어체는 "채굴"이란 용어는, 컨센서스의 주된 목적에 대한 오해를 불러일으킨다.  
흔히 사람들은 채굴의 목적이 새로운 화폐의 창출이라고 추측하는데, 현실 세계에서 채굴의 목적은 귀금속이나 다른 자원의 추출이기 때문일 것이다.  
채굴(다른 모든 컨센서스 모델 포함해서)의 진정한 목적은 블록체인을 안전하게 보호하고, 동시에 시스템을 분산시키고, 가능한 많은 참여자에게 분산시키는 것입니다.   
새로 주조된 화폐의 보상은 시스템의 보안에 기여하는 사람들에게 인센티브이다: 목적을 위한 수단이다.   
그런 의미에서 보상은 수단이고 탈중앙화 안보는 결과이다.  
PoW 컨센서스에도 채굴에 참여하기 위해 필요한 에너지 비용인 '처벌규정'이 있다.  
만약 참가자들이 규칙을 따르지 않고 보상을 받는다면, 그들은 이미 전력에 지출한 자금을 날리는 위험을 무릅쓴 것이다.  
따라서 PoW 컨센서스는 참가자가 사리사욕에서 벗어나 정직하게 행동하도록 만드는 세심한 위험과 보상의 균형입니다.  

이더리움은 현재 PoW 블록체인임  
이더리움의 PoW 는 비트코인의 PoW 와 약간 다르다  
이더리움의 PoW 는 Ethash 라고 부름  
본 글을 쓰는 시점에 이러디움은 또한 ProgPOW 롤 전환을 고려하고 있음  
ProgPOW 는 ASIC 내성 PoW 알고리즘을 적용했음  

# Consensus via Proof of Stake (PoS)
역사적으로, 작업 증명 알고리즘이 제안된 첫 번째 합의 알고리즘은 아니었다.  
작업 증명(Proof of Work)를 도입하기 전에는 많은 연구자들이 금액 걸기에 기반한 다양한 합의 알고리즘을 제안했는데, 현재는 PoS(Proof of 지분증명)로 불린다.  
어떤 점에서는, 작업 증명이 지분 증명의 대안으로 발명되었다.  
비트코인의 성공에 따라 많은 블록체인이 작업 증명를 모방했다.  
그러나 합의 알고리즘에 대한 연구가 폭발적으로 증가하면서 지분 증명도 되살아났고, 기술의 상태도 크게 발전했습니다.  
처음부터, Ethereum의 설립자들은 최종적으로 합의 알고리즘을 지분 증명으로 이전하기를 희망하고 있었다.  
사실, 난이도 폭탄이라고 불리는 Ethereum의 작업 증명에 고의적인 핸디캡이 있는데, 이는 Ethereum의 작업 증명 마이닝을 점점 더 어렵게 만들고, 이에 따라 지분 증명으로 전환하기 위한 의도였다.  

이 책이 출간될 당시에도 이더리움은 여전히 작업 증명를 사용하고 있지만, 현재 진행 중인 지분증명을 위한 연구가 거의 마무리 단계에 있다.  
Ethereum의 계획된 PoS 알고리즘은 Casper라고 불립니다.  
지난 2년 동안 Ethash를 대체할 캐스퍼의 도입이 여러 차례 연기되었음  
왜냐하면 난이도 폭탄을 해소하고 강제적인 작업 증명 폐기를 연기하기 위한 개입이 필요했기 때문임  

일반적으로 PoS 알고리즘은 다음과 같이 작동합니다.  
블록체인은 일련의 검증자를 추적하며, 블록체인의 기본 암호화 화폐(이더리움의 경우, 이더)를 보유한 사람이라면 누구나 이더를 잠그는 특수 형태의 거래를 예치금으로 보내면 검증자가 될 수 있다.  
검증자는 번갈아 다음 유효 블록에 대해 제안하고 투표하며, 각 검증자의 투표의 가중치는 보증금 규모(즉, 지분)에 따라 달라진다.  
중요한 것은 검증자가 보증금을 잃을 위험이 있다는 것이다.   
즉, 보증금을 걸었던 블록이 대다수의 검증자에 의해 거부될 경우 "삭감"될 위험이 있다.  
반대로, 검증자는 대다수가 수용하는 모든 블록에 대해 예치된 지분에 비례하여 약간의 보상을 받습니다. 따라서 PoS는 검증자들이 상벌 시스템에 의해 정직하게 행동하고 합의된 규칙을 따르도록 강요합니다.  
PoS와 PoW의 주요 차이점은 PoS에서의 처벌은 블록체인에 내재(예: 예치한 이더 손실)하는 반면 PoW에서의 처벌은 외부(예: 전력에 사용되는 자금 손실)라는 점이다.  

# Ethash: Ethereum’s Proof-of-Work Algorithm
Ethash는 Ethereum PoW 알고리즘입니다.  
Vitalik Buterin의 Dagger 알고리즘과 Thaddeus Dryja의 Hashimoto 알고리즘을 결합한 Dagger-Hashimoto 알고리즘의 진화를 사용합니다.  
Ethash는 지시된 비순환 그래프(또는 더 간단하게 "DAG")로 알려진 대규모 데이터 집합의 생성 및 분석에 따라 달라집니다. DAG의 초기 크기는 약 1GB였으며 크기는 매 epoch(3만 블록 또는 약 125시간)마다 업데이트되며 천천히 선형적으로 계속 증가할 것입니다.  

DAG의 목적은 자주 액세스하는 대규모 데이터 구조를 유지하는 데 의존하는 Ethash PoW 알고리즘을 만드는 것입니다.   
고속그래픽처리장치(GPU)보다 수배 빠른 애플리케이션별 집적회로(ASIC) 마이닝 장비를 만들기 어려운 'ASIC 저항성'을 만들기 위한 것이다.   
Ethereum의 설립자들은 전문 실리콘 제조 공장에 접근할 수 있는 권한과 거액의 예산이 있는 사람들이 마이닝 인프라를 장악하고 합의 알고리즘의 보안을 해칠 수 있는 PoW 마이닝에 대한 중앙 집중화를 피하고 싶어했습니다.  

Ethereum 네트워크에서 PoW를 수행하기 위해 소비자 수준의 GPU를 사용하는 것은 전 세계의 더 많은 사람들이 채굴 과정에 참여할 수 있다는 것을 의미한다.   
채굴자들이 독립할수록 채굴자들의 권력은 분산되어 있기 때문에 채굴 권력의 상당 부분이 소수의 대규모 산업 채굴 운영의 손에 집중되는 비트코인 같은 상황을 피할 수 있습니다.   
채굴에 GPU를 사용하는 단점은 2017년 전 세계적으로 GPU 부족 현상을 촉발해 가격이 치솟고 게이머들의 항의를 샀다는 점이다. 이로 인해 소매업체에서 구매 제한이 발생하여 구매자는 고객당 한두 개의 GPU로 제한되었습니다.  

최근까지만 해도, 이더리움 네트워크에서 ASIC 채굴자들의 위협은 대부분 존재하지 않았다.   
이더리움 전용 ASICs을 사용하려면 고도로 맞춤화된 하드웨어의 설계, 제조 및 배포가 필요합니다.   
그것들을 생산하기 위해서는 상당한 시간과 비용이 필요합니다.   
오랫동안 표현해온 Ethereum 개발자들의 PoS 컨센서스 알고리즘으로 이전하겠다는 계획은 ASIC 공급자들이 Ethereum 네트워크를 오랫동안 공략하지 못하도록 했을 가능성이 높다.   
Ethereum이 PoS로 전환되는 즉시 PoW 알고리즘을 위해 설계된 ASIC는 무용지물이 될 것입니다.   
단, 채굴자들이 대신 다른 가상화폐를 채굴하는 데 사용할 수 없다면 말입니다.   
PIRL, Ubiq 등 다양한 Ethash 기반의 컨센서스 코인을 사용할 수 있게 되면서 후자의 가능성이 현실화되고 있으며, Ethereum Classic은 당분간 PoW 블록체인으로 남을 것을 약속했다.   
이는 ASIC 채굴이 여전히 PoW 컨센서스에 따라 운영되고 있는 동안, 우리는 ASIC 채굴이 Ethereum 네트워크 상에서 힘을 얻기 시작하는 것을 볼 수 있다는 것을 의미한다.  

# Casper: Ethereum’s Proof-of-Stake Algorithm
Casper는 Ethereum의 PoS 컨센서스 알고리즘의 제안된 이름입니다.   
아직 활발한 연구개발 중이며, 이 책 출간 당시 이더리움 블록체인에 구현되지 않았다.  
Casper는 다음과 같은 두 가지 방향으로 개발되고 있습니다.  
+ Casper FFG: "The Friendly Finality Gadget"  
+ Casper CBC: "The Friendly GHOST/Correct-by-Construction"  

당초 카스퍼 FFG는 보다 영구적인 "순수 PoS" 알고리즘으로의 전환으로 구현될 하이브리드 PoW/PoS 알고리즘으로 제안되었다.   
그러나 2018년 6월 캐스퍼 FFG 연구를 주도하던 비탈릭 부테린은 순수 PoS 알고리즘을 위해 하이브리드 모델을 '폐기'하기로 결정했다.   
현재 Casper FFG와 Casper CBC는 둘 다 병렬로 개발되고 있습니다.   
Vitalik의 설명에 따르면:    
--
FFG와 CBC의 주요 단점은 CBC가 더 나은 이론적 특성을 가지고 있는 것으로 보이지만, FFG가 구현하기 더 쉬워 보인다는 것입니다.
-- 

카스퍼의 역사와 진행되는 연구에 관한 더 많은 정보는 아래 링크를 참고  

+ ![Ethereum Casper (Proof of Stake)](http://daum.net)

+ History of Casper, Part 1

+ History of Casper, Part 2

+ History of Casper, Part 3

+ History of Casper, Part 4

+ History of Casper, Part 5



# Principles of Consensus
# Controversy and Competition
# Conclusions
